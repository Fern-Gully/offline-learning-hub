server {
    listen 80 default_server;
    listen [::]:80 default_server;
    server_name library.local _;

    # Serve the Home at /
    root /var/www/html;
    index index.html;

    # Home landing
    location = / {
        try_files /index.html =404;
    }

    # QFD bushfire viewer (static files on disk)
    location ^~ /qfd/ {
        alias /var/www/html/qfd/;
        index index.html;
        autoindex off;
        add_header Cache-Control "no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0" always;
    }

    # Redirect /games without trailing slash
    location = /games {
        return 301 /games/;
    }

    # LAN Arcade
    location ^~ /games/ {
        alias /srv/games/www/;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    # Storms viewer
    location ^~ /storms/ {
        alias /var/www/html/storms/;
        index index.html;
        autoindex off;
        add_header Cache-Control "no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0" always;
    }

    # (No proxy_pass here; Kiwix lives on :8080 and is linked from Home)
    add_header X-Served-By "lan-portal" always;
}
